# 2ì¥

## ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜

- @Entity
    - í´ë˜ìŠ¤ë¥¼ í…Œì´ë¸”ê³¼ ë§¤í•‘
- @Table
    - ì—”í‹°í‹° í´ë˜ìŠ¤ì— ë§¤í•‘í•  í…Œì´ë¸” ì •ë³´ë¥¼ ì•Œë ¤ì¤Œ
    - ìƒëµì‹œ í´ë˜ìŠ¤ ì´ë¦„ì„ í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ë§¤í•‘ (ì—”í‹°í‹° ì´ë¦„)
- @Id
    - ì—”í‹°í‹° í´ë˜ìŠ¤ì˜ í•„ë“œë¥¼ í…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤ì— ë§¤í•‘
- @Column
    - í•„ë“œë¥¼ ì»¬ëŸ¼ì— ë§¤í•‘
- ë§¤í•‘ ì •ë³´ê°€ ì—†ëŠ” í•„ë“œ
    - ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ ìƒëµì‹œ í•„ë“œëª…ì„ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë§¤í•‘

- ì˜ˆì‹œ
    
    ```sql
    create table member (
    	id varchar(255) not null,
    	name varchar(255),
    	age integer,
    	primary key (id)
    }
    ```
    
    ```java
    // í´ë˜ìŠ¤
    public class Member {
    	private String id;
    	private String username;
    	private Integer age;
    	
    	//Getter, Setter
    	public String getId() {return id;}
    	public void setId(String id) { this.id = id;}
    	
    	public String getUsername() {return username;}
    	public void setUsername(String name) {this.username = username;}
    	
    	public Integer getAge() {return age;}
    	public void setAge(Integer age) { this.age = age;}
    	
    }
    	
    	
    ```
    
    ```java
    // JPA
    import javax.persistence.*;
    
    @Entity
    @Table(name="MEMBER")
    public class Member {
    	@Id
    	@Column(name="ID")
    	private String id;
    	
    	@Column(name="NAME")
    	private String username;
    	
    	//ë§¤í•‘ ì •ë³´ê°€ ì—†ëŠ” í•„ë“œ
    	private Integer age;
    	...
    	
    }
    ```
    
    - @Table : member ì—”í‹°í‹°ë¥¼ member í…Œì´ë¸”ì— ë§¤í•‘
    - @Id : member ì—”í‹°í‹°ì˜ username í•„ë“œë¥¼ member í…Œì´ë¸”ì˜ nameì— ë§¤í•‘
    

## ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸

- íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ë§Œì˜ ê³ ìœ í•œ ê¸°ëŠ¥
    - ex) mysqLì€ limit, ì˜¤ë¼í´ì€ rownum
- í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëŒ€ë¶€ë¶„ì˜ jpa êµ¬í˜„ì²´ëŠ” ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ í´ë˜ìŠ¤ë¥¼ ì œê³µ
    - ê°œë°œìëŠ” jpaê°€ ì œê³µí•˜ëŠ” í‘œì¤€ë¬¸ë²•ì— ë§ì¶”ì–´ ì‚¬ìš©í•˜ë©´, íŠ¹ì • dbì— ì˜ì¡´ì ì¸ sqlì€ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì´ ì²˜ë¦¬í•´ì¤Œ
    - ex) mysql : org.hibernate.dialect.MySQL5InnoDBDialect

## ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ

### ì—”í‹°í‹° ë§¤ë‹ˆì € ì„¤ì •

- ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬
    - persistence.xmlì˜ ì„¤ì • ì •ë³´ë¥¼ ì‚¬ìš©í•´ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±
        - persistence-unitì„ ì°¾ì•„ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±
            - ì˜ì†ì„± ìœ ë‹› : ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ìƒí˜¸ì‘ìš©ì„ ê´€ë¦¬í•˜ëŠ” ì„¤ì • ë‹¨ìœ„
    - ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì• í”„ë¦´ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ë”± í•œ ë²ˆë§Œ ìƒì„±í•˜ê³  ê³µìœ í•´ì„œ ì‚¬ìš©
- ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±
    - ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ì—ì„œ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±
    - ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•´ ì—”í‹°í‹°ë¥¼ dbì— ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ì¡°íšŒ
    - ë‚´ë¶€ì— ë°ì´í„°ì†ŒìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í†µì‹ 
        - ê°œë°œìëŠ” ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ê°€ìƒì˜ dbë¡œ ìƒê°í•  ìˆ˜ ìˆìŒ
    - ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ìŠ¤ë ˆë“œê°„ì— ê³µìœ í•˜ê±°ë‚˜ ì¬ì‚¬ìš© í•˜ë©´ ì•ˆë¨
        - ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ê³¼ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸
    
    <aside>
    ğŸ’¡
    
    ì—”í‹°í‹° ë§¤ë‹ˆì € : JPAì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ **CRUD ì‘ì—…(ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ)**ì„ ìˆ˜í–‰í•˜ëŠ” í•µì‹¬ ê°ì²´ì…ë‹ˆë‹¤. ì¦‰, ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ **í•˜ë‚˜ì˜ ë‹¨ìœ„ ì‘ì—…**ì„ ìˆ˜í–‰í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤
    
    </aside>
    
- ì¢…ë£Œ
    - ì‚¬ìš©ì´ ëë‚œ í›„ ë°˜ë“œì‹œ ì¢…ë£Œí•´ì•¼ í•¨

### íŠ¸ëœì­ì…˜ ê´€ë¦¬

- jpaì—ì„œëŠ” íŠ¸ëœì­ì…˜ ì—†ì´ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë©´ ì˜ˆì™¸ ë°œìƒ
- ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ í†µí•´ íŠ¸ëœì­ì…˜ apië¥¼ ë°›ì•„ì˜´

### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

- ë“±ë¡, ìˆ˜ì •, ì¡°íšŒ, ì‚­ì œ ë“±ì„ ìˆ˜í–‰

### ì˜ˆì‹œ

```java
package jpabook.start;

import javax.persistence.*;
import java.util.List;

public class JpaMain {
	public static void main(String[] args) {
		
		// [ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬] - ìƒì„±
		EntityManagerFactory emf = Persistence.createEntityManagerFactory("jpabook");
		// persistence.xmlì—ì„œ <persistence-unit name="">ìœ¼ë¡œ ì„¤ì •ëœ nameì„ íŒŒë¼ë¯¸í„°ë¡œ
		
		// [ì—”í‹°í‹° ë§¤ë‹ˆì €] - ìƒì„±
		EntityManager em = emf.createEntityManager();
		
		// [íŠ¸ëœì­ì…˜] - íšë“
		EntityTransaction tx = em.getTransaction();
		
		try {
			tx.begin(); // [íŠ¸ëœì­ì…˜] - ì‹œì‘
			logic(em); // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
			tx.commit(); // [íŠ¸ëœì­ì…˜] - ì»¤ë°‹
		} catch (Exception e) {
			tx.rollback(); // [íŠ¸ëœì­ì…˜] - ë¡¤ë°±
		} finally {
			em.close(); // [ì—”í‹°í‹° ë§¤ë‹ˆì €] - ì¢…ë£Œ
		}
		emf.close(); // [ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬] - ì¢…ë£Œ
	}
	
	// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
	private static void logic(EntityManager em) {...}
}
```

```java
// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì½”ë“œ ì˜ˆì‹œ
public static void logic(EntityManager em) {
	String id = "id1";
	Member member = new Member();
	member.setId(id);
	memeber.setUsername("ì§€í•œ");
	member.setAge(2);
	
	// ë“±ë¡
	em.persist(member);
	
	// ìˆ˜ì •
	memeber.setAge(20);
	
	// í•œ ê±´ ì¡°íšŒ
	Member findMember = em.find(Member.class, id);
	System.out.println(findMember.getUsername() + " " + findMember.getAge());
	
	// ëª©ë¡ ì¡°íšŒ
	List<Member> members = em.createQuery("select m from Member m", Member.class).getResultList();
	System.out.println("members.size=" + members.size());
	
	//ì‚­ì œ		
	em.remove(member);
}
		
```

- ì €ì¥
    - persist()
        - ì—”í‹°í‹° ì €ì¥
- ìˆ˜ì •
    - ì–´ë–¤ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ì¶”ì 
    - ì—”í‹°í‹°ê°’ë§Œ ë³€ê²½í•˜ë©´ update sqlì„ ìƒì„±í•´ì„œ ìë™ìœ¼ë¡œ ë³€ê²½
- ì‚­ì œ
    - remove()
- í•œ ê±´ ì¡°íšŒ
    - find()
        - ì—”í‹°í‹° íƒ€ì…ê³¼ dbì˜ ê¸°ë³¸ í‚¤ì™€ ë§¤í•‘í•œ ì‹ë³„ì ê°’ìœ¼ë¡œ ì¡°íšŒ
- JPQL
    - SQLì„ ì¶”ìƒí™”í•œ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´
    - ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬ (í´ë˜ìŠ¤ì™€ í•„ë“œë¥¼ ëŒ€ìƒìœ¼ë¡œ)
    - jpqlì€ dbì˜ í…Œì´ë¸”ì„ ì „í˜€ ì•Œì§€ ëª»í•¨
    - em.createQueryë¥¼ í†µí•´ ì¿¼ë¦¬ ê°ì²´ë¥¼ ìƒì„±í•œ í›„, getResultList ë©”ì†Œë“œ í˜¸ì¶œ
